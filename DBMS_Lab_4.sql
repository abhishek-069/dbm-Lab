DBMS LAB 4

CREATE TABLE FLIGHTS (
    FLNO INTEGER,
    SOURCE VARCHAR(255),
    DESTINATION VARCHAR(255),
    DISTANCE INTEGER,
    DEPARTS VARCHAR(8),  
    ARRIVES VARCHAR(8),
    PRICE INTEGER
);

CREATE TABLE AIRCRAFT (
    AID INTEGER,
    ANAME VARCHAR(255),
    CRUISINGRANGE INTEGER
);

CREATE TABLE CERTIFIED (
    EID INTEGER,
    AID INTEGER
);

CREATE TABLE EMPLOYEES (
    EID INTEGER,
    ENAME VARCHAR(255),
    SALARY INTEGER
);


INSERT INTO FLIGHTS VALUES (101, 'MYSURU', 'BANGLORE', 140, '09:30:00', '10:30:00', 5000);
INSERT INTO FLIGHTS VALUES (102, 'MYSURU', 'HASSAN', 120, '13:00:00', '14:00:00', 4500);
INSERT INTO FLIGHTS VALUES (103, 'MYSURU', 'MANGLORE', 600, '06:00:00', '09:00:00', 15000);
INSERT INTO FLIGHTS VALUES (104, 'MYSURU', 'BALLARY', 750, '07:00:00', '12:00:00', 19500);
INSERT INTO FLIGHTS VALUES (105, 'BANGLORE', 'HYDERABAD', 850, '12:00:00', '16:00:00', 20000);

INSERT INTO AIRCRAFT VALUES (1001, 'KINGFISHER', 2500);
INSERT INTO AIRCRAFT VALUES (2002, 'DECCAN', 2800);
INSERT INTO AIRCRAFT VALUES (3003, 'DISHAN', 3000);
INSERT INTO AIRCRAFT VALUES (4004, 'GOLBIBO', 750);
INSERT INTO AIRCRAFT VALUES (5005, 'LOCAL', 900);

INSERT INTO EMPLOYEES VALUES (11, 'SHIVAKUMAR', 150000);
INSERT INTO EMPLOYEES VALUES (12, 'BHASKAR', 75000);
INSERT INTO EMPLOYEES VALUES (13, 'DISHANKRISHNA', 200000);
INSERT INTO EMPLOYEES VALUES (15, 'VISHNU', 80000);
INSERT INTO EMPLOYEES VALUES (20, 'DHANU', 90000);

INSERT INTO CERTIFIED VALUES (11, 3003);
INSERT INTO CERTIFIED VALUES (11, 1001);
INSERT INTO CERTIFIED VALUES (11, 2002);
INSERT INTO CERTIFIED VALUES (13, 4004);
INSERT INTO CERTIFIED VALUES (12, 2002);


SELECT * FROM FLIGHTS;
SELECT * FROM AIRCRAFT;
SELECT * FROM EMPLOYEES;
SELECT * FROM CERTIFIED;


A)  Find the names of aircraft such that all pilots certified to operate them earn more than $80,000. 
-- A. SELECT ANAME FROM AIRCRAFT A, EMPLOYEES E, CERTIFIED C WHERE A.AID = C.AID AND E.EID = C.EID AND E.SALARY > 80000;


B) For each pilot who is certified for more than three aircraft, find the eid and the maximum cruising range of the aircraft for which she or he is certified. 
-- B. SELECT E.EID, MAX(A.CRUISINGRANGE) FROM EMPLOYEES E, CERTIFIED C, AIRCRAFT A WHERE E.EID = C.EID AND A.AID = C.AID GROUP BY E.EID HAVING COUNT(*) > 3;

C) For all aircraft with cruising range over 1000 miles, find the name of the aircraft and the average salary of all pilots certified for this aircraft. 
-- C. SELECT A.ANAME ,AVG(SALARY) FROM EMPLOYEES E, CERTIFIED C , AIRCRAFT A WHERE C.EID = E.EID AND A.AID = C.AID AND A.CRUISINGRANGE>1000 GROUP BY A.ANAME;

D) Print the Enames of pilots who can operate planes with cruising range greater than 3000 miles but are not certified on any Boeing aircraft.
-- D. (SELECT ENAME FROM EMPLOYEES E, CERTIFIED C WHERE C.AID IN  ( SELECT A.AID FROM AIRCRAFT A, CERTIFIED C WHERE A.AID NOT IN  ( SELECT AID FROM AIRCRAFT WHERE ANAME = 'BOEING' OR CRUISINGRANGE=3000) GROUP BY A.AID ) AND E.EID = C.EID) MINUS (SELECT ENAME FROM EMPLOYEES E, CERTIFIED C WHERE C.AID IN (  SELECT A.AID FROM AIRCRAFT A, CERTIFIED C WHERE A.AID IN  (SELECT AID FROM AIRCRAFT WHERE ANAME = 'BOEING') GROUP BY A.AID) AND E.EID = C.EID);

E) Print the name and salary of every non-pilot whose salary is more than the average salary for pilots.
-- E. SELECT EID, ENAME, SALARY FROM EMPLOYEES WHERE SALARY > (SELECT AVG(SALARY) FROM EMPLOYEES) AND EID NOT IN ( SELECT EID FROM CERTIFIED);
